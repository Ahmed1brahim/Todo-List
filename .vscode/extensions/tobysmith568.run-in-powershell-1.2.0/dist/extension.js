(()=>{"use strict";var e={143:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.commandBuilder=void 0,n.commandBuilder=(e,n,o,t,i)=>`"${e}" -NoProfile -ExecutionPolicy Unrestricted -Command "${r(e,n,o,t,i)}"`;const r=(e,n,r,t,i)=>{const s=t?" -Verb RunAs":"",a=i?"":" -NoExit";return`& {Start-Process ${o(e)}${s} -ArgumentList '-NoProfile${a} -ExecutionPolicy Unrestricted -Command cd ${o(n)} ; & ${o(r)}'}`},o=e=>e.replace(/( |\(|\))/g,"`$1")},496:e=>{e.exports=require("vscode")},81:e=>{e.exports=require("child_process")},17:e=>{e.exports=require("path")},837:e=>{e.exports=require("util")}},n={};function r(o){var t=n[o];if(void 0!==t)return t.exports;var i=n[o]={exports:{}};return e[o](i,i.exports,r),i.exports}var o={};(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.run=e.getFileLocation=e.runInPowershell=e.deactivate=e.activate=void 0;const n=r(17),t=r(837),i=r(496),s=r(81),a=r(143),c=t.promisify(s.exec),u="runInPowerShell.PowershellCoreLocation",d="runInPowerShell.CloseWhenFinished",l="powershell.exe";let p;async function m(e,n){const r=w(e);void 0!==r?await h(r,n):i.window.showErrorMessage("No file is currently open")}function w(e){let n=e?.fsPath;return void 0===n&&(n=i.window.activeTextEditor?.document.fileName),n}async function h(e,r=!1){const o=(0,n.dirname)(e);let t=i.workspace.getConfiguration().get(u);void 0!==t&&0!==t.length||(t=l);const s=i.workspace.getConfiguration().get(d)??!1,m=(0,a.commandBuilder)(t,o,e,r,s);p.appendLine("Running Powershell command: "+m);try{const{stdout:e,stderr:n}=await c(m);n&&p.appendLine("ERR: "+n),e&&p.appendLine("OUT: "+e)}catch(e){p.appendLine(JSON.stringify(e)),i.window.showErrorMessage(JSON.stringify(e))}p.appendLine("Finished running Powershell command")}e.activate=function(e){p=i.window.createOutputChannel("Run in Powershell");let n=i.commands.registerCommand("run-in-powershell.runInPS",(async e=>m(e,!1))),r=i.commands.registerCommand("run-in-powershell.runInPSAdmin",(async e=>m(e,!0)));e.subscriptions.push(n),e.subscriptions.push(r)},e.deactivate=function(){},e.runInPowershell=m,e.getFileLocation=w,e.run=h})(),module.exports=o})();